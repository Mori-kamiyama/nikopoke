#!/bin/bash

# ãƒ‹ã‚³ãƒã‚±CLI é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

echo "ðŸŽ® ãƒ‹ã‚³ãƒã‚±CLI é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™..."

# å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
DIST_DIR="nikopoke-cli-dist"
rm -rf "$DIST_DIR"
mkdir -p "$DIST_DIR"

# ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ï¼ˆã‚¯ãƒªãƒ¼ãƒ³ãƒ“ãƒ«ãƒ‰ï¼‰
echo "ðŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ãƒ“ãƒ«ãƒ‰ä¸­..."
cargo clean
echo "ðŸ“¦ ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã‚’ä½œæˆä¸­..."
cargo build --release --bin debug-cli --bin battle-cli

# å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼
echo "ðŸ“‹ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ä¸­..."
cp target/release/debug-cli "$DIST_DIR/"
cp target/release/battle-cli "$DIST_DIR/"

# ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆå®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã«åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹ãŒã€å¿µã®ãŸã‚ï¼‰
cp -r data "$DIST_DIR/"

# READMEã‚’ä½œæˆ
cat > "$DIST_DIR/README.md" << 'EOF'
# ðŸŽ® ãƒ‹ã‚³ãƒã‚± ãƒãƒˆãƒ«CLI

ãƒ‹ã‚³ãƒã‚±ç”¨ã®ãƒãƒˆãƒ«ã‚¨ãƒ³ã‚¸ãƒ³ ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

## ðŸ“¦ å†…å®¹ç‰©

- `debug-cli` - ãƒ‡ãƒãƒƒã‚°CLIï¼ˆæ©Ÿèƒ½ãŒè±Šå¯Œï¼‰
- `battle-cli` - ãƒãƒˆãƒ«CLIï¼ˆå¯¾æˆ¦å°‚ç”¨ï¼‰
- `data/` - ãƒã‚±ãƒ¢ãƒ³ãƒ»æŠ€ãƒ‡ãƒ¼ã‚¿

## ðŸš€ ä½¿ã„æ–¹

### Debug CLIï¼ˆæŽ¨å¥¨ï¼‰

```bash
./debug-cli
```

**æ©Ÿèƒ½:**
- ðŸŽ® ãƒãƒˆãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- ðŸ“Š ãƒã‚±ãƒ¢ãƒ³æƒ…å ±ç¢ºèª
- âš”ï¸ æŠ€æƒ…å ±ç¢ºèª
- ðŸ§® ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—æ©Ÿ

**æ—¥æœ¬èªžæ¤œç´¢æ©Ÿèƒ½:**
- ãƒã‚±ãƒ¢ãƒ³ã‚„æŠ€ã‚’é¸æŠžã™ã‚‹éš›ã€ã²ã‚‰ãŒãªãƒ»ã‚«ã‚¿ã‚«ãƒŠã§æ¤œç´¢ã§ãã¾ã™
- å…¥åŠ›ã§çµžã‚Šè¾¼ã‚ã¾ã™ï¼ˆä¾‹: 'ã´ã‹ã¡ã‚…ã†' â†’ 'pikachu'ï¼‰

### Battle CLI

```bash
./battle-cli
```

**æ©Ÿèƒ½:**
- 3vs3ã®ãƒãƒˆãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- AIã¨ã®å¯¾æˆ¦
- è©³ç´°ãƒ¢ãƒ¼ãƒ‰ï¼ˆæŠ€ã‚’è‡ªåˆ†ã§é¸æŠžï¼‰

## âš¡ ãƒ’ãƒ³ãƒˆ

- Debug CLIã®æŠ€é¸æŠžç”»é¢ã§ã€`/moves` ã‚³ãƒžãƒ³ãƒ‰ã§æŠ€ã®è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™
- Battle CLIã§ã¯è©³ç´°ãƒ¢ãƒ¼ãƒ‰ã§æŠ€ã‚’é¸ã¹ã¾ã™ï¼ˆèµ·å‹•æ™‚ã«é¸æŠžï¼‰
- ãƒ­ãƒ¼ãƒžå­—ã§æ¤œç´¢ã§ãã‚‹ã®ã§ã€ã€Œ10ã¾ã‚“ãƒœãƒ«ãƒˆã€ã¯ã€Œ10manã€ã§æ¤œç´¢å¯èƒ½

## ðŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### macOSã§ã€Œé–‹ç™ºå…ƒãŒæœªç¢ºèªã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆ

1. ã‚·ã‚¹ãƒ†ãƒ è¨­å®š â†’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
2. ã€Œã“ã®ã¾ã¾é–‹ãã€ã‚’ã‚¯ãƒªãƒƒã‚¯

ã¾ãŸã¯ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œ:

```bash
xattr -d com.apple.quarantine debug-cli
xattr -d com.apple.quarantine battle-cli
```

### å®Ÿè¡Œæ¨©é™ãŒãªã„å ´åˆ

```bash
chmod +x debug-cli battle-cli
```

## ðŸ“ ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦

- `data/species.json` - ãƒã‚±ãƒ¢ãƒ³ãƒ‡ãƒ¼ã‚¿
- `data/moves.json` - æŠ€ãƒ‡ãƒ¼ã‚¿
- `data/learnsets.json` - ç¿’å¾—æŠ€ãƒ‡ãƒ¼ã‚¿

ãƒ‡ãƒ¼ã‚¿ã¯å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã«åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹ã®ã§ã€`data/`ãƒ•ã‚©ãƒ«ãƒ€ã¯å‰Šé™¤ã—ã¦ã‚‚å‹•ä½œã—ã¾ã™ã€‚

---

æ¥½ã—ã‚“ã§ãã ã•ã„ï¼ ðŸŽ‰
EOF

# ZIPåœ§ç¸®
echo "ðŸ—œï¸  ZIPåœ§ç¸®ä¸­..."
zip -r nikopoke-cli-macos.zip "$DIST_DIR"

echo ""
echo "âœ… å®Œæˆï¼"
echo ""
echo "ðŸ“ é…å¸ƒãƒ•ã‚¡ã‚¤ãƒ«:"
echo "   - nikopoke-cli-macos.zip (å‹é”ã«æ¸¡ã™ãƒ•ã‚¡ã‚¤ãƒ«)"
echo ""
echo "ðŸ“¦ ä¸­èº«:"
ls -lh "$DIST_DIR"
echo ""
echo "ðŸ’¡ ä½¿ã„æ–¹:"
echo "   1. nikopoke-cli-macos.zip ã‚’å‹é”ã«é€ã‚‹"
echo "   2. è§£å‡ã—ã¦ ./debug-cli ã‚’å®Ÿè¡Œ"
echo ""
