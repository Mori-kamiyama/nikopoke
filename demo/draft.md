# nikipoke Demo 版 仕様書 (案)

## 1. 目的
`engine` ディレクトリにあるバトルロジックを使用し、ブラウザ上で実際に遊べるデモアプリケーションを作成する。
AI（Minimax/MCTS）との対戦および、Socket.io を用いたリアルタイム対戦を可能にする。

## 2. 技術スタック
- **Frontend**: React, Tailwind CSS, Lucide React (アイコン)
- **Backend**: Node.js, Express, Socket.io
- **AI**: Minimax法 / MCTS (Monte Carlo Tree Search)
- **Engine**: 既存の `nikipoke/engine` をコアロジックとして利用

## 3. 主要機能
### 3.1 バトルモード
- **Player vs AI**: AI (Minimax または MCTS) と対戦。
- **Player vs Player**: 特定のルームに入室して他のプレイヤーと対戦。
- **AI vs AI (観戦)**: 強化学習やアルゴリズムの比較用。

### 3.2 UI 画面
- **ロビー画面**: プレイヤー名入力、モード選択、ルームID入力。
- **バトル画面**: 
    - 自分のモンスターと相手のモンスターのステータス（HP, レベル, 状態異常）。
    - 技選択ボタン（4つの技）。
    - モンスター交代ボタン。
    - バトルログ（メッセージ表示）。
- **リザルト画面**: 勝敗結果、リプレイ保存、タイトルへ戻る。

### 3.3 AI 実装案
- **Minimax**: 
    - `stepBattle` をシミュレートして数ターン先を読み、評価関数（HP、有利対面、状態異常、ステータスランク）で最善手を選択。
- **MCTS**: 
    - プレイアウトを繰り返し、勝利確率の高い手を選択。

## 4. 通信仕様 (Socket.io)
### Client -> Server
- `join_room`: ルームへの入室（ID、チーム情報）。
- `submit_action`: 技の選択または交代の送信。

### Server -> Client
- `battle_init`: 対戦開始時の初期状態（相手のチーム情報など）。
- `battle_update`: 毎ターンの結果（ログ、更新されたHP、アニメーションキュー）。
- `battle_end`: 対戦終了通知と最終結果。

## 5. ロードマップ
1. **フェーズ1: サーバー基盤**: Socket.io で簡単な疎通確認。
2. **フェーズ2: AI 実装**: Minimax/MCTS の基本ロジックを `engine` 上に構築。
3. **フェーズ3: フロントエンド構築**: 基本的なバトル UI の作成。
4. **フェーズ4: 統合**: サーバー・クライアント・AI を繋ぎ込み、実際に遊べるようにする。
5. **フェーズ5: ブラッシュアップ**: アニメーションの追加、詳細な評価関数の調整。
